# Modern Nix-Polyglot Justfile
# This file delegates to nix commands - updates automatically with flake updates
# No manual maintenance required - core functionality comes from nix-polyglot

# Default recipe - shows available commands
default:
    @just --list

# Start development environment
dev:
    @echo "ğŸš€ Start development environment..."
    nix develop

# Build project
build:
    @echo "ğŸ”¨ Build project..."
    nix build

# Run project
run:
    @echo "â–¶ï¸  Run project..."
    nix run

# Run release version
release:
    @echo "ğŸ¯ Run release version..."
    nix run .#release

# Run all tests and checks
test:
    @echo "ğŸ§ª Run all tests and checks..."
    nix flake check

# Format all code (universal formatter)
fmt:
    @echo "ğŸ¨ Format all code (universal formatter)..."
    nix fmt

# Check formatting without changes
fmt-check:
    @echo "ğŸ” Check formatting without changes..."
    nix fmt -- --fail-on-change

# Run linting checks
lint:
    @echo "ğŸ” Run linting checks..."
    nix run .#lint

# Verify code formatting
check-format:
    @echo "âœ… Verify code formatting..."
    nix run .#check-format

# Comprehensive check - build + test + lint + format
check: build test lint fmt-check
    @echo "âœ… All checks passed!"

# Clean build artifacts
clean:
    @echo "ğŸ§¹ Clean build artifacts..."
    nix-collect-garbage && rm -rf result result-*

# Update all dependencies
update:
    @echo "ğŸ“¦ Update all dependencies..."
    nix flake update

# Regenerate NuGet dependencies
update-nuget:
    @echo "ğŸ“¦ Regenerating NuGet dependencies..."
    @python3 generate-deps.py

# Show project information
info:
    @echo "ğŸ“‹ Show project information..."
    nix flake show
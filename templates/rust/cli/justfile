# Modern Nix-Polyglot Justfile for Rust
# This file delegates to nix commands - updates automatically with flake updates

# Default recipe - shows available commands
default:
    @just --list

# Start development environment
dev:
    @echo "🚀 Start development environment..."
    nix develop

# Build project
build:
    @echo "🔨 Build project..."
    nix build

# Run project
run:
    @echo "▶️  Run project..."
    nix run

# Run release version
release:
    @echo "🎯 Run release version..."
    nix run .#release

# Run all tests and checks
test:
    @echo "🧪 Run all tests and checks..."
    nix flake check

# Format all code
fmt:
    @echo "🎨 Format all code..."
    nix fmt

# Check formatting
fmt-check:
    @echo "🔍 Check formatting without changes..."
    nix fmt -- --fail-on-change

# Comprehensive check
check: build test fmt-check
    @echo "✅ All checks passed!"

# Clean build artifacts
clean:
    @echo "🧹 Clean build artifacts..."
    nix-collect-garbage && rm -rf result result-* target/

# Update dependencies
update:
    @echo "📦 Update all dependencies..."
    nix flake update

# Show project information
info:
    @echo "📋 Show project information..."
    nix flake show